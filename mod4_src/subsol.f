      SUBROUTINE SUBSOL(THETAS,PHIS,TIME,IDAY)

!     PARAMETERS:
      INCLUDE 'ERROR.h'

!     SUBROUTINE SUBSOL CALCULATES THE SUBSOLAR POINT ANGLES
!     THETAS AND PHIS BASED UPON IDAY AND TIME. SINCE EACH
!     YEAR IS 365.25 DAYS LONG THE EXACT VALUE OF THE DECLINATION
!     ANGLE CHANGES FROM YEAR TO YEAR.  FOR PRECISE VALUES CONSULT
!     ' THE AMERICAN EPHEMERIS AND NAUTICAL ALMANAC' PUBLISHED YEARLY
!     BY THE U.S. GOVT. PRINTING OFFICE.  ALSO, THE SOLAR POSITION
!     IS CHARACTERIZED BY 25 POINTS BELOW; THIS SHOULD PREDICT THE SUBSO
!     ANGLES WITHIN ONE DEGREE.  FOR INCREASED ACCURACY ADD MORE DATA
!     POINTS

!     THE EQUATION OF TIME, EQT, IS IN MINUTES
!     THE DECLINATION ANGLE, DEC IS IN DEGREES

!     COMMONS:
      INCLUDE 'IFIL.h'

!     DECLARE BLOCK DATA ROUTINES EXTERNAL:
      EXTERNAL DEVCBD
      DIMENSION NDAY(25),EQT(25),DEC(25)
      DATA NDAY /1,9,21,32,44,60,91,121,141,152,160,172,182,            &
     & 190,202,213,244,274,305,309,325,335,343,355,366/
      DATA DEC /-23.07,-22.22,-20.08,-17.32,-13.62,-7.88,4.23,          &
     & 14.83, 20.03,21.95,22.87,23.45,23.17,22.47,20.63,18.23,8.58,     &
     & -2.88,-14.18,-15.45,-19.75,-21.68,-22.75,-23.43,-23.07/
      DATA EQT /-3.23,-6.83,-11.17,-13.57,-14.33,-12.63,-4.2,           &
     & 2.83,3.57,2.45,1.10,-1.42,-3.52,-4.93,-6.25,-6.28,-0.25,         &
     & 10.02,16.35,16.38,14.3,11.27,8.02,2.32,-3.23/
      IF(IDAY.LT.1.OR.IDAY.GT.366)  GO TO 900
      IF(TIME.LT.0.0.OR.TIME.GT.24.0)  GO TO 910
      DO 10 I=1,25
      IF(NDAY(I).EQ.IDAY) GO TO 30
10    IF(NDAY(I).GT.IDAY) GO TO 20
20    I=I-1
      EQTIME=EQT(I)+(EQT(I+1)-EQT(I))*(IDAY-NDAY(I))/(NDAY(I+1)-NDAY(I))
      DECANG=DEC(I)+(DEC(I+1)-DEC(I))*(IDAY-NDAY(I))/(NDAY(I+1)-NDAY(I))
      GO TO 40
30    EQTIME=EQT(I)
      DECANG=DEC(I)
40    THETAS=DECANG
      EQTIME=EQTIME/60.0
      PHIS=15.0*(TIME+EQTIME)-180.0
      IF(PHIS.LT.0.0) PHIS=PHIS+360.0
      RETURN
! JMASS WARNING MESSAGE?
900   WRITE(IPR,901) IDAY
901   FORMAT(' FROM SUBSOL - IDAY OUT OF RANGE, IDAY=',I6)
      IF(LJMASS) THEN
         RETURN
      ELSE
         STOP
      ENDIF
910   WRITE(IPR,902) TIME
902   FORMAT(' FROM SUBSOL - TIME OUT OF RANGE, TIME=',E12.5)
      IF(LJMASS) THEN
         RETURN
      ELSE
         STOP
      ENDIF
      END
